# Trivy configuration file
# This configuration is used for scanning the repository

# Scan configuration
scanners:
  - vuln
  - secret
  - license
# Note: misconfig scanner removed as it's for IaC files (Terraform, CloudFormation, etc.)
# and causes errors with AWS policies that aren't relevant for Node.js app repo scans

# Vulnerability types to scan
vuln-type:
  - os
  - library

# Severity levels to report
severity:
  - UNKNOWN
  - LOW
  - MEDIUM
  - HIGH
  - CRITICAL

# Exit code when vulnerabilities are found
exit-code: 1

# Ignore unpatched vulnerabilities (set to false to show all)
ignore-unfixed: false

# Output format
format: table

# Skip directories (optional)
# Note: node_modules removed from skip-dirs as Trivy needs to scan installed packages for vulnerabilities
skip-dirs:
  - .git
  - build
  - dist
  - frontend/dist

# Skip files (optional)
# Note: package-lock.json removed from skip-files as Trivy needs it to detect vulnerabilities

# Timeout for scan
timeout: 10m0s

